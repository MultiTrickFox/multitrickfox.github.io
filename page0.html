<html>

    <head>
      <title>MultiTrickFox's Space</title>
      <link rel="icon" type="image/x-icon" href="favicon.png">
      <script src="libs/p5.js"></script>
      <!-- <script src="libs/p5.sound.js"></script> -->
      <script src="libs/p5.easycam.js"></script>
      <script src="libs/p5.rovercam.js"></script>
    </head>

    <body style="
          background-color: black;
          margin: 0;
          height: 100%;
          width: 100%;
          justify-content: center;
          align-items: center;
          cursor: wait;               
          ">
      
      <script>

        const skybox_size = 2_000

        const floor_epsilon = .8

        var camera_y_lock = true

        var canvas
        var cam

        function setup() {
  
          setAttributes('antialias', true)
          pixelDensity(1)

          canvas = createCanvas(windowHeight, windowHeight, WEBGL)
          canvas.position((windowWidth-windowHeight)/2,0)

          //cam = createEasyCam()
          cam = createRoverCam()
          cam.usePointerLock()
          cam.setState({
            position: [0,0,0],
            rotation: [0,0,0],
            sensitivity: 0.01,
            speed: .2,
          })

          document.body.style.cursor = 'auto'

        }

        function draw() {

          background(0)

          //lights()
          //ambientLight(128, 128, 128) and directionalLight(128, 128, 128, 0, 0, -1)

          //light that comes from everywhere on the canvas. It has no particular source.
          //ambientLight(100) // white light
          //ambientMaterial(255, 102, 94) // magenta material

          //regular point light
          //pointLight(v1, v2, v3, x, y, z)

          //a color and a direction
          //directionalLight(v1, v2, v3, x, y, z)
          // directionalLight(255,0,0, skybox_size/4,0,0) // behind camera
          // directionalLight(0,255,0, 0,0,skybox_size/4) // left of camera
          // directionalLight(0,0,255, 0,0,-skybox_size/4) // right of camera
          // directionalLight(0,255,255, 0,skybox_size/4,0) // top of camera

          //color, position, direction of light, angle and concentration.
          //spotLight(v1, v2, v3, x, y, z, rx, ry, rz, [angle], [conc])
          // spotLight(255,0,0, -skybox_size,0,0, 1,0,0, Math.PI/2, 255) // behind camera
          // spotLight(0,255,0, 0,0,-skybox_size, 0,0,1, Math.PI/2, 255) // left of camera
          // spotLight(0,0,255, 0,0,skybox_size, 0,0,-1, Math.PI/2, 255) // right of camera
          // spotLight(0,255,255, 0,-skybox_size,0, 0,1,0, Math.PI/2, 255) // top of camera

          spotLight(255,0,0, -skybox_size,0,0, 1,0,0, Math.PI/2, 255) // behind camera
          spotLight(0,255,0, 0,0,-skybox_size, 0,0,1, Math.PI/2, 255) // left of camera
          spotLight(0,0,255, 0,0,skybox_size, 0,0,-1, Math.PI/2, 255) // right of camera
          spotLight(0,255,255, 0,-skybox_size,0, 0,1,0, Math.PI/2, 255) // top of camera

          stroke(0)
          fill(255)//0)
          box(skybox_size)

          push()
          translate(100, 0, 0)
          stroke(0)
          fill(255)
          box(50)
          pop()

          push()
          translate(200, 0, 100)
          stroke(0)
          fill(255)
          box(50)
          pop()

          push()
          translate(300, 0, -100)
          stroke(0)
          fill(255)
          box(50)
          pop()

          if (camera_y_lock) {
            if (Math.abs(cam.position.y) <= floor_epsilon) cam.position.y = 0
            else cam.position.y /=1.016
          }
          else if (!camera_y_lock) {
            if (cam.position.y > skybox_size/4) cam.position.y = skybox_size/4
            else if (cam.position.y < -skybox_size/4) cam.position.y = -skybox_size/4
          }
          if (cam.position.x > skybox_size/4) cam.position.x = skybox_size/4
          else if (cam.position.x < -skybox_size/4) cam.position.x = -skybox_size/4
          if (cam.position.z > skybox_size/4) cam.position.z = skybox_size/4
          else if (cam.position.z < -skybox_size/4) cam.position.z = -skybox_size/4

        }

        this.onkeypress = function(event) {

          switch(event.keyCode) {

            case 13: // enter
              break

            case 32: // space
              camera_y_lock = !camera_y_lock
              break

            //default: alert(event.keyCode)

          }

        }

      </script>

    </body>

</html>