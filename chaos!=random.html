<html>

    <head>
      <title>Chaos != Random</title>
      <link rel="icon" type="image/x-icon" href="favicon.png">
      <script src="libs/p5.js"></script>
      <script src="libs/p5.rovercam.js"></script>
    </head>

    <body style="
          background-color: black;
          margin: 0;
          height: 100%;
          width: 100%;
          justify-content: center;
          align-items: center;
          cursor: wait;               
          ">
      
      <script>

        const skybox_size = 2_500

        const box_size = 50
        const box_locations = [
          [100, 0, 0],
          [200, 0, 100],
          [300, 0, -100],
        ]

        const floor_epsilon = .8
        var camera_y_lock = true

        var canvas
        var cam

        function setup() {
  
          setAttributes('antialias', true)
          pixelDensity(1)
          //colorMode(HSB, 360)

          canvas = createCanvas(windowWidth, windowHeight, WEBGL)
          canvas.position((windowWidth-width)/2,0)

          //cam = createEasyCam()
          cam = createRoverCam()
          cam.usePointerLock()
          cam.setState({
            position: [0,0,0],
            rotation: [0,0,0],
            sensitivity: 0.006,
            speed: .2,
          })

          document.body.style.cursor = 'auto'

        }

        function draw() {

          background(0)

          spotLight(0,0,255, -skybox_size,0,0, 1,0,0, Math.PI/2, 255) // behind camera
          spotLight(0,255,255, 0,0,-skybox_size, 0,0,1, Math.PI/2, 255) // left of camera
          spotLight(255,0,255, 0,0,skybox_size, 0,0,-1, Math.PI/2, 255) // right of camera

          spotLight(255,0,0, 0,-skybox_size,0, 0,1,0, Math.PI/2, 255) // top of camera
          spotLight(255,255,0, 0,skybox_size,0, 0,-1,0, Math.PI/2, 255) // bot of camera

          noStroke()
          fill(255)//0)
          box(skybox_size)

          for (var i = 0; i < box_locations.length; i++) {
            push()
            translate(box_locations[i][0], box_locations[i][1], box_locations[i][2])

            stroke(0)

            //fill(255)
            //normalMaterial()
            //ambientMaterial(255)
            specularMaterial(255,255,255, 255)//255*.77)
            shininess(10)

            box(box_size)
            // sphere(box_size/2)

            pop()
          }

          if (camera_y_lock) {
            if (Math.abs(cam.position.y) <= floor_epsilon) cam.position.y = 0
            else cam.position.y /=1.016
          }
          else if (!camera_y_lock) {
            if (cam.position.y > skybox_size/4) cam.position.y = skybox_size/4
            else if (cam.position.y < -skybox_size/4) cam.position.y = -skybox_size/4
          }
          if (cam.position.x > skybox_size/4) cam.position.x = skybox_size/4
          else if (cam.position.x < -skybox_size/4) cam.position.x = -skybox_size/4
          if (cam.position.z > skybox_size/4) cam.position.z = skybox_size/4
          else if (cam.position.z < -skybox_size/4) cam.position.z = -skybox_size/4
          
        }

        this.onkeypress = function(event) {

          switch(event.keyCode) {

            case 13: // enter
              break

            case 32: // space
              camera_y_lock = !camera_y_lock
              break

            //default: alert(event.keyCode)

          }

        }

      </script>

    </body>

</html>